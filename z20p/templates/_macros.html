## REMEMBER TO ADD AN IMPORT TO _base.html
{% macro render_field(field) %}
  <dt>{% if field.name != "submit" %}{{ field.label }}{% endif %}
  <dd>{{ field(**kwargs)|safe }}
  {% if field.errors %}
    <ul class=errors>
    {% for error in field.errors %}
      <li>{{ error }}</li>
    {% endfor %}
    </ul>
  {% endif %}
  </dd>
{% endmacro %}
{% macro td_field(field) %}
  <td title="{{field.name}}">{{ field(**kwargs)|safe }}
  {% if field.errors %}
    <ul class=errors>
    {% for error in field.errors %}
      <li>{{ error }}</li>
    {% endfor %}
    </ul>
  {% endif %}
  </td>
{% endmacro %}
## TODO rename to render_article
{% macro display_article(article, crop=False) -%}
    <article class="{{'crop' if crop else 'regular'}}" id="{{'article' if article.is_article else 'reaction'}}-{{article.id}}">
        {% if article.media %}
            {% if crop %} <a href="{{article.url}}">
            {% else %} <a href="{{article.media.url}}">{% endif %}
            <img src="{{article.media.url}}" title="{{article.media.title}}" alt="{{article.title}} - obrázek" class="image">
            </a>
        {% endif %}
        {% if article.rating %}
            <div class="ratingbox">
                <span class="rating">{{ article.rating.rating }}</span><span class="outof">/10</span>
            </div>
        {% endif %}
        {% if article.title %}
            <h1><a href="{{article.url}}">{{ article.title }}</a></h1>
        {% endif %}
        {% if not crop %}
            <p>{{article.text|replace("\n", "\n<p>")|safe}}
        {% else %}
            <ul class="platforms">
            {% for label in article.labels %}
                {% if label.category == 'platform' %}
                    <li><a href="/search/label/{{label.id}}">{{label.name}}</a>
                {% endif %}
            {% endfor %}
            </ul>
            {{icon("images-stack", "Obrázků")}}×{{ article.all_media|count }} {{icon("blogs-stack", "Reakcí")}}×{{ article.reactions|count }}
        {% endif %}
        <footer>
            <div class="dateline">{{icon("calendar-blue", "Datum publikace:")}} {{article.timestamp|datetime}}</div> 
            <ul class="labels">
                {% for label in article.labels %}
                    <li><a href="/search/label/{{label.id}}">{{label.name}}</a>
                {% endfor %}
            </ul>
            <div class="authorline">Napsal{{g(article.author.gender)}}: <author><a href="/users/{{article.author.id}}">{{article.author.name}}</a></author>{{'★' if article.author.rights >= 1}}</div>       
            {% if session.user.admin or session.user == article.author %}<div class="adminline"><a href="{{article.url}}/edit">{{icon("pencil", "Editovat")}}</a></div>{% endif %}
            <div style="clear:both;"></div>  
        </footer>        
    </article>
{%- endmacro %}
{% macro render_pages(page, count, url_args) %}
    <p>Stránka {{ page }} z {{ (count//5)+1 }}
    <p>
        {%- for p in range(1, (count//5)+2) -%}
            {%- if p == page -%}
                <strong>{{p}}</strong>{{"," if not loop.last else ""}}
            {% else -%}
                <a href='{{url_for("search", page=p, **url_args)}}'>{{p}}</a>{{"," if not loop.last else ""}}
            {% endif %}
        {% endfor %}
{% endmacro %}
{% macro icon(name, alt, title="") -%}
<img src="/static/icons/{{name}}.png" alt="{{alt}}" title="{{alt if title=='' else title}}" width=16 height=16>
{%- endmacro %}
## This really needs some more thinking through...
{% macro g(gender=None) -%}
{{{'m':'', 'f':'a', '-':'o'}[gender if gender else session.user.gender]}}
{%- endmacro %}
